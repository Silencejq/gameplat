<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"> 
<meta name="viewport" content="width=device-width, initial-scale=1"> 
<title>login</title>
<link rel="stylesheet" type="text/css" href="css/normalize.css" />
<link rel="stylesheet" type="text/css" href="css/demo.css" />
<!--必要样式-->
<link rel="stylesheet" type="text/css" href="css/component.css" />
<!--[if IE]>
<script src="js/html5.js"></script>
<![endif]-->
</head>
<body>
	<div class="container demo-1">
		<div class="content">
			<div id="large-header" class="large-header">
				<canvas id="demo-canvas"></canvas>
				<div class="logo_box">
					<h3>欢迎你</h3>
					<form action="#" name="f" method="post">
						<div class="input_outer">
							<span class="u_user"></span>
							<input id="userName" name="logname" class="text" style="color: #FFFFFF !important" type="text" placeholder="请输入账户">
						</div>
						<div class="input_outer">
							<span class="us_uer"></span>
							<input id="userPassWord" name="logpass" class="text" style="color: #FFFFFF !important; position:absolute; z-index:100;" value=""
							    type="password" placeholder="请输入密码">
						</div>
						<div class="mb2">
							<a id="login" class="act-but submit" href="javascript:;" style="color: #FFFFFF">登录</a>
						</div>
					</form>
				</div>
			</div>
		</div>

		</div><!-- /container -->
		<script src="js/TweenLite.min.js"></script>
		<script src="js/EasePack.min.js"></script>
		<script src="js/rAF.js"></script>
		<script src="js/demo-1.js"></script>
		<script src="js/jquery.min.js"></script>
		<script src="js/jquery.cookie.js"></script>
	</body>
	<script src="./lib/layui/layui.js" charset="utf-8"></script>
<!-- 	<script type="text/javascript">
			
				layui.extend({
			admin: '{/}./static/js/admin'
		});
					layui.use(['form','admin'], function(){
						var form = layui.form
							,admin = layui.admin;
						// layer.msg('玩命卖萌中', function(){
						//   //关闭后的操作
						//   });
						//监听提交
						form.on('submit(login)', function(data){
							// alert(888)
							layer.msg(JSON.stringify(data.field),function(){
									location.href='./index.html'
							});
							return false;
						});
					});   
	</script -->>  
	<script type="text/javascript">
		function lockUp(userName){
			var lockCount=userName+"lockCount";
			var lockName=userName+"lockName";
			var count =$.cookie(lockCount);
			var lockTime=$.cookie(lockName);
			if(lockTime==null||lockTime==""){
				var date=new Date();
				date.setTime(date.getTime()+ 24 * 60 * 60 * 1000);
			    if(count == null||count == ""){
					$.cookie(lockCount,1,{
						path:'/',
						expires:date
						});
					return false;	
				}else{
					var date=new Date();
					date.setTime(date.getTime()+24*60*60*1000);
					var count =$.cookie(lockCount);
					if(count<=3){
						$.cookie(lockCount,++count,{
							path:'/',
							expires:date
							
						});
						return false;
					}else{
						var date=new Date();
						date.setTime(date.getTime()+30*60*1000);
						$.cookie(lockName,"lockName",{
							path:'/',
							expires:date
							
						});
						$.cookie(count,null);
						return true;
					}		
				}	
					
			}else {
				return true;
			};
		};
	</script>
	<script type="text/javascript">
		$(document).ready(function(){
			var storage = window.localStorage;
			$("#login").click(function(){
			var userName = $("#userName").val();
			var userPassWord=$("#userPassWord").val();
			if(userName==''||userPassWord==''){
				alert("账号和密码不能为空!!!是不是傻")
			}
			// else if	(userName!=''&&userPassWord!=''&&lockUp(userName)==false){
			else if	(userName!=''&&userPassWord!=''){

				// alert("账号没有锁定");
				$.ajax({
					type:"GET",
					url:"/jiadian/login/login",
					data:{"userName":userName,"userPassWord":userPassWord},
					dataType:"json",
					success:function(data){
						if (data.message == "Success") {
							var cc=data.data.id
							var aa=data.data.name
							var role=data.data.role
							storage["login"] = cc;
							storage["Name"] = aa;
							storage["role"] = role;
							// alert(storage["login"]+storage["Name"]+storage["role"]);
							
							window.location.href = 'index.html';
						}else{
							alert('账号密码错误');
							
						}
						
						
					},
					error:function(){
						alert("好像哪里不太对");
					}
					
					
				});
			}
			else if(lockUp(userName)==true)
				alert("账号锁定，30分钟后再试");
				
				
			});
			
			
			
			
			
			
			
			
			
			
			
			
			
		});
	</script>
</html>